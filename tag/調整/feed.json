{
    "version": "https://jsonfeed.org/version/1",
    "title": "taniho's blog • All posts by \"調整\" tag",
    "description": "technical note",
    "home_page_url": "http://blog.taniho.net",
    "items": [
        {
            "id": "http://blog.taniho.net/2017/11/%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%83%9E%E3%82%A6%E3%82%B9%E8%AA%BF%E6%95%B4%E6%B3%95-%E5%83%95%E5%90%91%E3%81%91/",
            "url": "http://blog.taniho.net/2017/11/%E3%83%9E%E3%82%A4%E3%82%AF%E3%83%AD%E3%83%9E%E3%82%A6%E3%82%B9%E8%AA%BF%E6%95%B4%E6%B3%95-%E5%83%95%E5%90%91%E3%81%91/",
            "title": "マイクロマウス調整法(僕向け)",
            "date_published": "2017-11-02T05:24:24.000Z",
            "content_html": "<h1 id=\"はじめに\"><a href=\"#はじめに\" class=\"headerlink\" title=\"はじめに\"></a>はじめに</h1><p>こんにちは．地区大会も残すところ中部だけとなり，あとは全日本に向けて仕上げていく時期となってまいりました．<br>みなさんマウスの調整はお済みでしょうか？</p>\n<p><a href=\"http://tenpura.sugo-roku.com/%E5%A3%81%E5%88%B6%E5%BE%A1/tofreshman\">マイクロマウス調整法（フレッシュマン向け） 徒然なるままに書きつくれば</a></p>\n<p>さて早速ですが，先輩の記事にあやかって僕の調整のやり方を書き残しておこうと思います．ただし，</p>\n<blockquote>\n<p>※今回の記事は個人の主義主張が強く含まれます。調整方法がコレで正解というわけではないので、あくまで一意見としてお聞きください。</p>\n</blockquote>\n<p>ということでお願いします．</p>\n<a id=\"more\"></a>\n\n<h1 id=\"機体パラメータ\"><a href=\"#機体パラメータ\" class=\"headerlink\" title=\"機体パラメータ\"></a>機体パラメータ</h1><p>いろんなパラメータを合わせる前に，必ず調整が必要なパラメータがいくつかあります．</p>\n<ul>\n<li>PIDゲイン</li>\n<li>ジャイロセンサの”Angular rate sensitivity”</li>\n<li>タイヤ径</li>\n</ul>\n<p>このパラメータを変更するとすべてのパラメータを見直す必要があるため，<strong>必ず調整前に確認</strong>します．</p>\n<h2 id=\"PIDゲイン\"><a href=\"#PIDゲイン\" class=\"headerlink\" title=\"PIDゲイン\"></a>PIDゲイン</h2><p>重心速度制御，角速度制御のそれぞれゲインを合わせます．</p>\n<p>僕は決め打ちでゲインを合わせています．挙動を見て概ね良さそうなところまでもっていき，後は速度・角速度ログを見ながら微調整します．</p>\n<h2 id=\"ジャイロセンサの”Angular-rate-sensitivity”\"><a href=\"#ジャイロセンサの”Angular-rate-sensitivity”\" class=\"headerlink\" title=\"ジャイロセンサの”Angular rate sensitivity”\"></a>ジャイロセンサの”Angular rate sensitivity”</h2><p>単位が[dps/LSB]とか[mdps/LSB]とかで表されるアレです．<br>アナログジャイロの場合は特に，データシート通りの値ではない場合があるので必ず確認します．</p>\n<p>調整方法は，180°の超信地旋回を10回〜20回程度走らせて，止まった時の角度を確認します．</p>\n<h2 id=\"タイヤ径\"><a href=\"#タイヤ径\" class=\"headerlink\" title=\"タイヤ径\"></a>タイヤ径</h2><p>タイヤ径は最も重要なパラメータの一つだと思いますが，一旦計算値を入れておき，<strong>両壁での壁制御ができるようになってから</strong>調整を行います．</p>\n<p>理由は2つあります．</p>\n<ul>\n<li>壁制御をかけた方が距離の計測がやりやすいから</li>\n<li>本番でも壁制御を使うため，壁制御があることを前提としてタイヤ径を合わせたほうが良いから</li>\n</ul>\n<p>調整方法は，迷路上にできるだけ長い直線区間を用意し，全区間に両壁を入れた状態でn区画走らせます．停止した地点がどれだけずれているかを確認し，タイヤ径を調整します．<br>そのため，スタート地点とゴール地点には補助線を引いておいたほうがいいでしょう．</p>\n<h1 id=\"壁制御\"><a href=\"#壁制御\" class=\"headerlink\" title=\"壁制御\"></a>壁制御</h1><h2 id=\"左右センサのリファレンス値・Pゲイン\"><a href=\"#左右センサのリファレンス値・Pゲイン\" class=\"headerlink\" title=\"左右センサのリファレンス値・Pゲイン\"></a>左右センサのリファレンス値・Pゲイン</h2><p>壁制御のあれこれを説明する前に，まずは両壁での壁制御ができるようにします．<br>左右センサのリファレンス値は，前壁が存在しない迷路の中央にマウスを置き，平均値を取ります．</p>\n<p>Pゲインは，次の条件を(数字の若い項目を優先して)満たすようにがんばります．</p>\n<ol>\n<li>どれだけ端に寄せても暴走しない</li>\n<li>半区画で角度が戻る</li>\n<li>1区画で中心に戻る</li>\n</ol>\n<p>ここまで合わせてから，タイヤ径の調整を行います．</p>\n<h2 id=\"壁の存在閾値\"><a href=\"#壁の存在閾値\" class=\"headerlink\" title=\"壁の存在閾値\"></a>壁の存在閾値</h2><p>壁が存在するかどうかを判断する閾値を調整します．</p>\n<p>機械的に調整しようと試したことがあるのですが，うまくいきませんでした．したがって，直感とトライアルアンドエラーで調整しています．</p>\n<h2 id=\"壁切れの閾値\"><a href=\"#壁切れの閾値\" class=\"headerlink\" title=\"壁切れの閾値\"></a>壁切れの閾値</h2><p>壁切れの閾値は，壁の存在閾値と別に設定しています．<br>ただし，基本的に</p>\n<p>(壁切れの閾値) = (壁の存在閾値) - n<br>n = 5 〜 20 程度の定数</p>\n<p>みたいな感じでマシンごとに決めています．</p>\n<h1 id=\"スラローム\"><a href=\"#スラローム\" class=\"headerlink\" title=\"スラローム\"></a>スラローム</h1><p>一番大変なスラロームの調整です．探索時に使う小回りのスラロームについて書きます．</p>\n<p>スラロームについて詳しくはこちらを参照してください．<br><a href=\"http://tenpura.sugo-roku.com/%E3%83%9E%E3%82%A6%E3%82%B9/%E3%83%9E%E3%82%A6%E3%82%B9%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%82%B9%E3%83%A9%E3%83%AD%E3%83%BC%E3%83%A0%E8%B5%B0%E8%A1%8C\">マウスにおけるスラローム走行 徒然なるままに書きつくれば</a></p>\n<h2 id=\"スラローム調整項目\"><a href=\"#スラローム調整項目\" class=\"headerlink\" title=\"スラローム調整項目\"></a>スラローム調整項目</h2><p>スラロームには様々なパラメータがありますが，代表的なところでは</p>\n<ul>\n<li>角加速度</li>\n<li>転回する合計の角度</li>\n<li>前距離・後ろ距離</li>\n<li>円弧軌道で転回する角度</li>\n</ul>\n<p>があると思います．<br>ここで，円弧軌道で転回する角度は，転回する合計の角度の 1/3 で固定しています．(どうしても調整が難しい場合のみ変更)</p>\n<h2 id=\"合計の角度を調整\"><a href=\"#合計の角度を調整\" class=\"headerlink\" title=\"合計の角度を調整\"></a>合計の角度を調整</h2><p>まずはスラロームの角度を調整します．<br>次の迷路を5周程度周回させ，角度のみ直します．</p>\n<img src=\"slalom1.png\" width=\"400\" />\n\n<p>初めの直進時には，角度を直すために壁制御を有効化しておきます．それ以外では無効化しておきます．</p>\n<h2 id=\"前距離後ろ距離を調整\"><a href=\"#前距離後ろ距離を調整\" class=\"headerlink\" title=\"前距離後ろ距離を調整\"></a>前距離後ろ距離を調整</h2><p>次に前距離と後ろ距離を調整します．<br>次の迷路を走らせ(直進→90°旋回→直進)，停止位置がどれだけずれているか確認します．ずれを分かりやすくするため，図のように補助線を引いておくことをオススメします．</p>\n<img src=\"slalom2.png\" width=\"400\" />\n\n<p>初めの直進時には，角度を直すために壁制御を有効化しておきます．旋回後の直進時は余計な制御がかからないように壁制御を無効化します．</p>\n<h2 id=\"壁切れから区画までの距離\"><a href=\"#壁切れから区画までの距離\" class=\"headerlink\" title=\"壁切れから区画までの距離\"></a>壁切れから区画までの距離</h2><p>最後に壁切れの調整です．壁切れの閾値は調整済であるとして，壁切れが発生した地点が区画(柱と柱の間)からどれだけの距離であるか，設定する必要があります．これは左右のセンサの角度によって決まるため，右と左で別々に調整する必要があります．</p>\n<p>調整迷路は，前距離後ろ距離の調整迷路と同じです．壁切れを有効化して，スラロームが正しい場所で終わることを確認します．</p>\n<h2 id=\"スラローム調整用迷路\"><a href=\"#スラローム調整用迷路\" class=\"headerlink\" title=\"スラローム調整用迷路\"></a>スラローム調整用迷路</h2><p>最後に，小回りスラロームがきちんと出来ているか検証するため，特訓迷路を紹介して終わりにします．</p>\n<img src=\"slalom3.png\" width=\"400\" />\n\n<img src=\"slalom4.png\" width=\"200\" />\n\n<p>下の迷路は非常に重要で，問題なく走行することで「左右の前距離と後ろ距離の合計値が正しい」ことが保証されます．ただし，下の迷路を走れたからと言って上の迷路を走れるとは限らないので，どちらも試してみることをオススメします．</p>\n<h1 id=\"さいごに\"><a href=\"#さいごに\" class=\"headerlink\" title=\"さいごに\"></a>さいごに</h1><p>きあいでちょうせいするのはつらい</p>\n",
            "tags": [
                "マイクロマウス",
                "調整"
            ]
        }
    ]
}